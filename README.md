# Комплексный пайплайн для разработки лекарств

Этот проект представляет собой комплексный вычислительный пайплайн, предназначенный для ускорения процесса открытия новых лекарственных молекул. Он автоматизирует ключевые этапы, начиная от сбора и обработки данных о биологической активности до генерации, отбора и оценки новых молекулярных кандидатов.

## О проекте

Цель этого проекта — предоставить гибкий и расширяемый инструмент для исследователей в области хемоинформатики и машинного обучения. Пайплайн объединяет в себе несколько последовательных этапов:

1.  **Сбор и обработка данных**: Автоматическая загрузка данных о биологической активности из публичных баз данных, таких как ChEMBL и PubChem. Включает предварительную обработку, очистку и стандартизацию данных для последующего использования.
2.  **Генерация дескрипторов**: Вычисление различных молекулярных дескрипторов и фингерпринтов (RDKit, Mordred, Morgan), которые характеризуют физико-химические и структурные свойства молекул.
3.  **Обучение предиктивной модели**: Тренировка модели машинного обучения (XGBoost) для предсказания биологической активности (pIC50) на основе молекулярных дескрипторов. Включает в себя оптимизацию гиперпараметров с помощью Optuna для достижения наилучшей производительности.
4.  **Генерация новых молекул**: Этот этап предполагает использование внешних инструментов, таких как REINVENT, для создания новых молекулярных структур.
5.  **Виртуальный скрининг и отбор**: Многоступенчатая фильтрация сгенерированных кандидатов. Сначала применяются программные фильтры (QED, SA Score, PAINS/Brenk), затем используется обученная модель для предсказания активности. На финальном этапе предлагается использовать внешний инструмент SwissADME для оценки ADME-свойств и токсичности.

## Начало работы

Весь пайплайн управляется через единый интерфейс командной строки (`main.py`), что обеспечивает простоту использования и воспроизводимость.

### Предварительные требования

Перед началом работы убедитесь, что у вас установлен Python и все необходимые зависимости.

```bash
pip install -r requirements.txt
```

### Структура проекта

Проект имеет следующую структуру:
```
├── configs/                # Файлы конфигурации
├── data/                   # Данные (raw, processed, features, generated)
├── scripts/                # Скрипты для каждого этапа пайплайна
├── src/                    # Исходный код с основной логикой
├── main.py                 # Главный CLI для управления пайплайном
└── README.md
```

### Быстрый старт

Вы можете запустить весь пайплайн одной командой:

```bash
python main.py run-all
```
Эта команда последовательно выполнит все этапы: подготовку данных, обучение модели, генерацию и отбор молекул.

Также можно запускать каждый этап по отдельности:
```bash
# Этап 1: Подготовка данных
python main.py prepare-data

# Этап 2: Обучение модели
python main.py prepare-predictor

# Этап 3: Генерация новых молекул
python main.py generate-molecules

# Этап 4: Отбор молекул-кандидатов
python main.py select-molecules
```
**Важно:** Некоторые шаги, такие как генерация молекул с помощью REINVENT и анализ в SwissADME, требуют ручного вмешательства. Скрипт предоставит подробные инструкции в командной строке, когда это будет необходимо.

## 🛠Основные технологии и библиотеки

*   **Хемоинформатика**: RDKit, Mordred
*   **Машинное обучение**: Scikit-learn, XGBoost, Optuna
*   **Обработка данных**: Pandas, NumPy
*   **API и загрузка данных**: ChEMBL Webresource Client, PubChemPy
*   **Управление**: Typer (для CLI)

# Полная структура проекта

```
.
├── configs
│   └── main_config.yaml
├── data
│   ├── 01_raw
│   │   ├── chembl_CHEMBL4822_raw.csv
│   │   └── pubchem_P56817_raw.csv
│   ├── 02_processed
│   │   ├── all_processed.csv
│   │   ├── chembl_CHEMBL4822_processed.csv
│   │   └── pubchem_P56817_processed.csv
│   ├── 03_features
│   │   └── CHEMBL4822_rdkit.csv
│   ├── 04_generated
│   │   └── sampling.csv
│   └── 05_selected
│       ├── 01_program_filtered.csv
│       ├── 02_pic50_filtered.csv
│       ├── 03_for_swissadme.txt
│       ├── 04_final_ranked_hits.csv
│       └── swissadme.csv
├── main.py
├── models
│   ├── columns.json
│   └── model.joblib
├── requirements.txt
├── scripts
│   ├── generate_molecules.py
│   ├── prepare_data.py
│   ├── prepare_predictor.py
│   └── select_molecules.py
└── src
    ├── data
    │   ├── descriptors.py
    │   ├── download.py
    │   ├── preprocess.py
    │   └── score.py
    ├── predictor.py
    └── utils.py
```
